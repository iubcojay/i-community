const a28_0x221948=a28_0x21c4;(function(_0x5835b0,_0x58f327){const _0x4d24c6=a28_0x21c4,_0x646891=_0x5835b0();while(!![]){try{const _0x343e51=-parseInt(_0x4d24c6(0x15f))/0x1+-parseInt(_0x4d24c6(0x166))/0x2+-parseInt(_0x4d24c6(0x18c))/0x3+parseInt(_0x4d24c6(0x17f))/0x4*(-parseInt(_0x4d24c6(0x176))/0x5)+parseInt(_0x4d24c6(0x197))/0x6+parseInt(_0x4d24c6(0x175))/0x7+parseInt(_0x4d24c6(0x164))/0x8;if(_0x343e51===_0x58f327)break;else _0x646891['push'](_0x646891['shift']());}catch(_0x7083d4){_0x646891['push'](_0x646891['shift']());}}}(a28_0x4e9f,0x3aff1));const fs=require('fs'),path=require('path'),areaModel=require(a28_0x221948(0x160)),transportAccidentModel=require('../model/TransportAccidentModel'),taskModel=require(a28_0x221948(0x179)),_=require(a28_0x221948(0x16e)),moment=require('moment');function getNewTimeStamp(){const _0x1d1945=a28_0x221948;return transportAccidentModel[_0x1d1945(0x171)]();}function updateAccidentTime(_0xdd35d8){const _0x579728=a28_0x221948;transportAccidentModel[_0x579728(0x194)](_0xdd35d8);}function addFireTask(_0x454989,_0x236eb6,_0x548bca,_0x7d5369,_0x4e6327,_0x2bbf2f,_0x25274f){const _0x399c9f=a28_0x221948;_0x25274f=_0x25274f[_0x399c9f(0x177)](_0x580043=>({'areaId':_0x580043[_0x399c9f(0x186)],'userId':_0x580043[_0x399c9f(0x181)],'acceptTime':_0x580043['acceptTime'],'finishTime':_0x580043['finishTime'],'status':_0x580043[_0x399c9f(0x180)]}));const _0x1e5ca0={'id':-0x1,'title':_0x454989,'description':_0x236eb6,'status':_0x548bca,'createTime':_0x7d5369,'scheduledTime':_0x4e6327,'finishTime':_0x2bbf2f,'participantInfo':_0x25274f};taskModel['insertTask'](_0x1e5ca0);}function addTask(_0x195323,_0x58e33a,_0x5e9b21,_0x5e88b1,_0x312cc7,_0xfb83c1,_0x188f96){const _0x3a3dff=a28_0x221948,_0x337451={'id':-0x1,'title':_0x195323,'description':_0x58e33a,'status':0x1,'createTime':new Date(),'scheduledTime':_0x5e9b21,'finishTime':null,'participantInfo':[]};_0x337451[_0x3a3dff(0x189)][_0x3a3dff(0x170)](..._0x5e88b1[_0x3a3dff(0x177)]((_0x490e4a,_0x3df1ff)=>{const _0xf411fe=_0x3a3dff;return{'areaId':_0x490e4a,'userId':_0x312cc7[_0x3df1ff],'acceptTime':_0x337451[_0xf411fe(0x196)],'finishTime':_0x337451[_0xf411fe(0x196)],'status':0x2};}),..._0xfb83c1[_0x3a3dff(0x177)]((_0x4312bd,_0x1c9137)=>{return{'areaId':_0x4312bd,'userId':_0x188f96[_0x1c9137],'acceptTime':null,'finishTime':null,'status':0x0};})),taskModel[_0x3a3dff(0x18f)](_0x337451);}function a28_0x4e9f(){const _0x13c669=['1-3','1-2','find','findIndex','241932RVeOxI','status','userId','stringify','acceptTime','flattenDeep','2-5','areaId','2-1','result','participantInfo','2022-09-20\x2010:18:06','2-3','1435014NZuEwd','exports','forEach','insertTask','seconds','ClassificationPolygon','selTaskList','updateTask','updateAccidentList','走访时住户不在家','createTime','1871814WocwMA','179119QvgJgX','../model/AreaModel','every','住户积极配合网格员的走访，如实回答了相关问题','1-4','8327032XfWGvZ','一号楼','933852YcBUfp','interviewInfo','selTaskById','date','plan','hours','cloneDeep','interviewPath','lodash','remark','push','getNewTimeStamp','{\x0d\x0a\x09\x22xbsjType\x22:\x20\x22ClassificationPolygon\x22,\x0d\x0a\x09\x22name\x22:\x20\x22一号楼\x22,\x0d\x0a\x09\x22positions\x22:\x20[\x0d\x0a\x09\x092.042804317855282,\x0d\x0a\x09\x090.6398840436683026,\x0d\x0a\x09\x092.0428046034982046,\x0d\x0a\x09\x090.6398816518944798,\x0d\x0a\x09\x092.0428134636956674,\x0d\x0a\x09\x090.6398823070947697,\x0d\x0a\x09\x092.0428132095547076,\x0d\x0a\x09\x090.6398845390625975\x0d\x0a\x09],\x0d\x0a\x09\x22height\x22:\x2029.103914916475517,\x0d\x0a\x09\x22color\x22:\x20[\x0d\x0a\x09\x090.3176470588235294,\x0d\x0a\x09\x090.42745098039215684,\x0d\x0a\x09\x090.9058823529411765,\x0d\x0a\x09\x090.51\x0d\x0a\x09],\x0d\x0a\x09\x22outline\x22:\x20{}\x0d\x0a}','month','finishTime','3055955XFwKUQ','35eDqJxv','map','1-1','../model/TaskModel','二号楼'];a28_0x4e9f=function(){return _0x13c669;};return a28_0x4e9f();}function getRelatedTaskListByUserId(_0x7f3f10){const _0x357117=a28_0x221948;let _0x3981e8=taskModel[_0x357117(0x192)]();return _0x3981e8=_0x3981e8['filter'](_0x16a4d4=>{const _0x349e11=_0x357117;return _0x16a4d4[_0x349e11(0x189)][_0x349e11(0x17e)](_0x49c514=>_0x49c514[_0x349e11(0x181)]===_0x7f3f10)!==-0x1;}),_0x3981e8;}function acceptTask(_0x78d7ae,_0x13406a){const _0x3cbe0b=a28_0x221948,_0x3babc5=taskModel[_0x3cbe0b(0x168)](_0x78d7ae),_0x101064=_0x3babc5[_0x3cbe0b(0x189)][_0x3cbe0b(0x17d)](_0xc9ee41=>_0xc9ee41[_0x3cbe0b(0x181)]===_0x13406a);_0x101064[_0x3cbe0b(0x180)]=0x1,_0x101064[_0x3cbe0b(0x183)]=new Date(),taskModel[_0x3cbe0b(0x193)](_0x3babc5);}function appointTask(_0x3697fc,_0xe198df,_0x3ec53b){const _0x2f0d58=a28_0x221948,_0x51ef38=taskModel['selTaskById'](_0x3697fc),_0x64f573=_0x51ef38[_0x2f0d58(0x189)][_0x2f0d58(0x17d)](_0x4a30b7=>_0x4a30b7[_0x2f0d58(0x181)]===_0xe198df);_0x64f573['finishTime']=new Date(),_0x64f573[_0x2f0d58(0x180)]=0x2,_0x3ec53b[_0x2f0d58(0x18e)](_0x2b3c9e=>{const _0x5963bd=_0x2f0d58;_0x51ef38[_0x5963bd(0x189)]['push']({'areaId':_0x2b3c9e[_0x5963bd(0x186)],'userId':_0x2b3c9e[_0x5963bd(0x181)],'acceptTime':null,'finishTime':null,'status':0x0});}),taskModel[_0x2f0d58(0x193)](_0x51ef38);}function appointTaskToGrid(_0x1c1e49,_0xd32ba,_0x5f4925){const _0x435599=a28_0x221948,_0x3b45e4=taskModel[_0x435599(0x168)](_0x1c1e49),_0x52b9a0=_0x3b45e4[_0x435599(0x189)]['find'](_0x368630=>_0x368630[_0x435599(0x181)]===_0xd32ba);_0x52b9a0['finishTime']=new Date(),_0x52b9a0[_0x435599(0x180)]=0x2,_0x5f4925['forEach'](_0x1537b8=>{const _0x523ef4=_0x435599;_0x3b45e4[_0x523ef4(0x189)][_0x523ef4(0x170)]({'areaId':_0x1537b8['areaId'],'userId':_0x1537b8[_0x523ef4(0x181)],'acceptTime':null,'finishTime':null,'status':0x0,'plan':'','result':'','interviewPath':'','interviewInfo':''});}),taskModel[_0x435599(0x193)](_0x3b45e4);}function gridAcceptTask(_0x51ba58,_0xc8637,_0x5e01f8){const _0x24641d=a28_0x221948,_0x21733b=taskModel['selTaskById'](_0x51ba58),_0x207d33=_0x21733b['participantInfo'][_0x24641d(0x17d)](_0x177558=>_0x177558[_0x24641d(0x181)]===_0xc8637);_0x207d33[_0x24641d(0x180)]=0x1,_0x207d33[_0x24641d(0x183)]=new Date(),_0x207d33[_0x24641d(0x16a)]=_0x5e01f8,_0x207d33[_0x24641d(0x16d)]=getFakeInterviewPath(),_0x207d33[_0x24641d(0x167)]=getFakeInterviewInformation(),taskModel[_0x24641d(0x193)](_0x21733b);}function gridFinishTask(_0x401723,_0x2d3cf1,_0x284da6){const _0x7be8ff=a28_0x221948,_0x19355c=taskModel[_0x7be8ff(0x168)](_0x401723),_0x195ec5=_0x19355c['participantInfo'][_0x7be8ff(0x17d)](_0xb7a445=>_0xb7a445[_0x7be8ff(0x181)]===_0x2d3cf1);_0x195ec5[_0x7be8ff(0x180)]=0x2,_0x195ec5[_0x7be8ff(0x188)]=_0x284da6,_0x195ec5[_0x7be8ff(0x174)]=new Date();const _0x77fb39=_[_0x7be8ff(0x161)](_0x19355c[_0x7be8ff(0x189)],_0x50f173=>_0x50f173['status']===0x2);_0x77fb39&&(_0x19355c[_0x7be8ff(0x174)]=new Date(),_0x19355c['status']=0x2),taskModel[_0x7be8ff(0x193)](_0x19355c);}function a28_0x21c4(_0x1ab020,_0x227cfd){const _0x4e9ffe=a28_0x4e9f();return a28_0x21c4=function(_0x21c488,_0xe13e44){_0x21c488=_0x21c488-0x15f;let _0x112944=_0x4e9ffe[_0x21c488];return _0x112944;},a28_0x21c4(_0x1ab020,_0x227cfd);}function getFakeInterviewPath(){const _0x5ce95f=a28_0x221948;let _0x2ddaca=[{'currentBuilding':{'id':0x1,'name':_0x5ce95f(0x165),'createTime':_0x5ce95f(0x18a),'cesiumCode':'{\x0d\x0a\x09\x22xbsjType\x22:\x20\x22ClassificationPolygon\x22,\x0d\x0a\x09\x22name\x22:\x20\x22一号楼\x22,\x0d\x0a\x09\x22positions\x22:\x20[\x0d\x0a\x09\x092.042804317855282,\x0d\x0a\x09\x090.6398840436683026,\x0d\x0a\x09\x092.0428046034982046,\x0d\x0a\x09\x090.6398816518944798,\x0d\x0a\x09\x092.0428134636956674,\x0d\x0a\x09\x090.6398823070947697,\x0d\x0a\x09\x092.0428132095547076,\x0d\x0a\x09\x090.6398845390625975\x0d\x0a\x09],\x0d\x0a\x09\x22height\x22:\x2029.103914916475517,\x0d\x0a\x09\x22color\x22:\x20[\x0d\x0a\x09\x090.3176470588235294,\x0d\x0a\x09\x090.42745098039215684,\x0d\x0a\x09\x090.9058823529411765,\x0d\x0a\x09\x090.51\x0d\x0a\x09],\x0d\x0a\x09\x22outline\x22:\x20{}\x0d\x0a}'},'currentFloor':{'id':0x1,'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':'ClassificationPolygon','name':_0x5ce95f(0x178),'positions':[2.04280484309749,0.639881669957266,2.0428133275673135,0.6398822168013933,2.0428130775346722,0.6398845192237631,2.042804632411323,0.6398839677074695],'height':11.562078136009863,'outline':{}})}},{'currentBuilding':{'id':0x1,'name':_0x5ce95f(0x165),'createTime':_0x5ce95f(0x18a),'cesiumCode':_0x5ce95f(0x172)},'currentFloor':{'id':0x2,'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':_0x5ce95f(0x17c),'positions':[2.04280484309749,0.639881669957266,2.0428133275673135,0.6398822168013933,2.0428130775346722,0.6398845192237631,2.0428043650417296,0.6398839677074695],'height':11.423305830581272,'extrudedHeight':14.112638097403593,'outline':{}})}},{'currentBuilding':{'id':0x1,'name':_0x5ce95f(0x165),'createTime':_0x5ce95f(0x18a),'cesiumCode':_0x5ce95f(0x172)},'currentFloor':{'id':0x3,'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':'ClassificationPolygon','name':_0x5ce95f(0x17b),'positions':[2.04280484309749,0.639881669957266,2.0428133275673135,0.6398822168013933,2.0428130775346722,0.6398845192237631,2.0428043650417296,0.6398839677074695],'height':13.542656623473917,'extrudedHeight':16.84114740048696,'outline':{}})}},{'currentBuilding':{'id':0x1,'name':'一号楼','createTime':_0x5ce95f(0x18a),'cesiumCode':_0x5ce95f(0x172)},'currentFloor':{'id':0x4,'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':_0x5ce95f(0x163),'positions':[2.04280484309749,0.639881669957266,2.0428133275673135,0.6398822168013933,2.0428130775346722,0.6398845192237631,2.0428043650417296,0.6398839677074695],'height':16.596522051144294,'extrudedHeight':19.627039508448593,'outline':{}})}},{'currentBuilding':{'id':0x1,'name':_0x5ce95f(0x165),'createTime':_0x5ce95f(0x18a),'cesiumCode':'{\x0d\x0a\x09\x22xbsjType\x22:\x20\x22ClassificationPolygon\x22,\x0d\x0a\x09\x22name\x22:\x20\x22一号楼\x22,\x0d\x0a\x09\x22positions\x22:\x20[\x0d\x0a\x09\x092.042804317855282,\x0d\x0a\x09\x090.6398840436683026,\x0d\x0a\x09\x092.0428046034982046,\x0d\x0a\x09\x090.6398816518944798,\x0d\x0a\x09\x092.0428134636956674,\x0d\x0a\x09\x090.6398823070947697,\x0d\x0a\x09\x092.0428132095547076,\x0d\x0a\x09\x090.6398845390625975\x0d\x0a\x09],\x0d\x0a\x09\x22height\x22:\x2029.103914916475517,\x0d\x0a\x09\x22color\x22:\x20[\x0d\x0a\x09\x090.3176470588235294,\x0d\x0a\x09\x090.42745098039215684,\x0d\x0a\x09\x090.9058823529411765,\x0d\x0a\x09\x090.51\x0d\x0a\x09],\x0d\x0a\x09\x22outline\x22:\x20{}\x0d\x0a}'},'currentFloor':{'id':0x5,'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':'ClassificationPolygon','name':'1-5','positions':[2.04280484309749,0.639881669957266,2.0428133275673135,0.6398822168013933,2.0428130775346722,0.6398845192237631,2.0428043650417296,0.6398839677074695],'height':19.396756001004334,'extrudedHeight':26.608883983529168,'outline':{}})}},{'currentBuilding':{'id':0x2,'name':'二号楼','createTime':_0x5ce95f(0x18a),'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':'二号楼','positions':[2.0428135448093485,0.6398845207670465,2.0428137992125808,0.6398823204068219,2.042820664908539,0.6398827650554295,2.0428204141684,0.6398849787949912],'height':28.89447698112241,'color':[0.11764705882352941,0.6196078431372549,0.6627450980392157,0.46],'outline':{}})},'currentFloor':{'id':0x6,'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':_0x5ce95f(0x187),'positions':[2.042814181776436,0.6398823535977225,2.042820629119561,0.6398828722076362,2.0428204073043927,0.6398850022781899,2.0428139080206047,0.6398845247313752],'height':10.55232924491058,'outline':{}})}},{'currentBuilding':{'id':0x2,'name':_0x5ce95f(0x17a),'createTime':'2022-09-20\x2010:18:06','cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':_0x5ce95f(0x17a),'positions':[2.0428135448093485,0.6398845207670465,2.0428137992125808,0.6398823204068219,2.042820664908539,0.6398827650554295,2.0428204141684,0.6398849787949912],'height':28.89447698112241,'color':[0.11764705882352941,0.6196078431372549,0.6627450980392157,0.46],'outline':{}})},'currentFloor':{'id':0x7,'cesiumCode':JSON['stringify']({'xbsjType':'ClassificationPolygon','name':'2-2','positions':[2.042814181776436,0.6398823535977225,2.042820629119561,0.6398828722076362,2.0428204073043927,0.6398850022781899,2.0428139080206047,0.6398845247313752],'height':10.55232924491058,'extrudedHeight':14.09384363945299,'outline':{}})}},{'currentBuilding':{'id':0x2,'name':_0x5ce95f(0x17a),'createTime':_0x5ce95f(0x18a),'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':'ClassificationPolygon','name':_0x5ce95f(0x17a),'positions':[2.0428135448093485,0.6398845207670465,2.0428137992125808,0.6398823204068219,2.042820664908539,0.6398827650554295,2.0428204141684,0.6398849787949912],'height':28.89447698112241,'color':[0.11764705882352941,0.6196078431372549,0.6627450980392157,0.46],'outline':{}})},'currentFloor':{'id':0x8,'cesiumCode':JSON['stringify']({'xbsjType':'ClassificationPolygon','name':_0x5ce95f(0x18b),'positions':[2.042814181776436,0.6398823535977225,2.042820629119561,0.6398828722076362,2.0428204073043927,0.6398850022781899,2.0428139080206047,0.6398845247313752],'height':14.032600257881015,'extrudedHeight':16.9106795060295,'outline':{}})}},{'currentBuilding':{'id':0x2,'name':'二号楼','createTime':_0x5ce95f(0x18a),'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':_0x5ce95f(0x17a),'positions':[2.0428135448093485,0.6398845207670465,2.0428137992125808,0.6398823204068219,2.042820664908539,0.6398827650554295,2.0428204141684,0.6398849787949912],'height':28.89447698112241,'color':[0.11764705882352941,0.6196078431372549,0.6627450980392157,0.46],'outline':{}})},'currentFloor':{'id':0x9,'cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':'2-4','positions':[2.042814181776436,0.6398823535977225,2.042820629119561,0.6398828722076362,2.0428204073043927,0.6398850022781899,2.0428139080206047,0.6398845247313752],'height':16.863063343283216,'extrudedHeight':20.152692535650576,'outline':{}})}},{'currentBuilding':{'id':0x2,'name':_0x5ce95f(0x17a),'createTime':'2022-09-20\x2010:18:06','cesiumCode':JSON[_0x5ce95f(0x182)]({'xbsjType':_0x5ce95f(0x191),'name':_0x5ce95f(0x17a),'positions':[2.0428135448093485,0.6398845207670465,2.0428137992125808,0.6398823204068219,2.042820664908539,0.6398827650554295,2.0428204141684,0.6398849787949912],'height':28.89447698112241,'color':[0.11764705882352941,0.6196078431372549,0.6627450980392157,0.46],'outline':{}})},'currentFloor':{'id':0xa,'cesiumCode':JSON['stringify']({'xbsjType':_0x5ce95f(0x191),'name':_0x5ce95f(0x185),'positions':[2.042814181776436,0.6398823535977225,2.042820629119561,0.6398828722076362,2.0428204073043927,0.6398850022781899,2.0428139080206047,0.6398845247313752],'height':20.106478153162268,'extrudedHeight':25.340349449697474,'outline':{}})}}],_0x3df012=0x1,_0x334c23=moment()['year'](0x7e7)[_0x5ce95f(0x173)](0x5)[_0x5ce95f(0x169)](0x3)[_0x5ce95f(0x16b)](0x8)['minutes'](0x1e)[_0x5ce95f(0x190)](0x0)['milliseconds'](0x0),_0x3e58c5=0x1e;return _0x2ddaca[_0x5ce95f(0x18e)](_0x2e05f7=>{_0x2e05f7['id']=_0x3df012++,_0x2e05f7['date']=_0x334c23['add'](_0x3e58c5,'minutes')['format']('MM/DD\x20HH:mm');}),_0x2ddaca;}function getFakeInterviewInformation(){const _0x5d1003=a28_0x221948;let _0x13efc2=[{'id':0x1,'name':_0x5d1003(0x165),'progress':[]},{'id':0x2,'name':_0x5d1003(0x17a),'progress':[]}];const _0x2348ea=[];for(let _0x59a8e1=0x1;_0x59a8e1<=0xe;_0x59a8e1++){_0x2348ea[_0x5d1003(0x170)]([{'houseNumber':_0x59a8e1+'01','status':-0x1,'remark':''},{'houseNumber':_0x59a8e1+'02','status':-0x1,'remark':''}]);}const _0xe646ee=[_['cloneDeep'](_0x2348ea),_[_0x5d1003(0x16c)](_0x2348ea),_['cloneDeep'](_0x2348ea)];return _[_0x5d1003(0x184)](_0xe646ee[0x0])[_0x5d1003(0x18e)](_0x751c02=>{const _0x4de66f=_0x5d1003;_0x751c02['status']=0x2,_0x751c02[_0x4de66f(0x16f)]=_0x4de66f(0x162);}),_['flattenDeep'](_0xe646ee[0x1])[_0x5d1003(0x18e)]((_0x4363d1,_0x4830bd)=>{const _0x3a1756=_0x5d1003;if([0x3,0x5,0xa]['includes'](_0x4830bd))_0x4363d1[_0x3a1756(0x180)]=0x1,_0x4363d1[_0x3a1756(0x16f)]=_0x3a1756(0x195);else _0x4830bd<0xe?(_0x4363d1[_0x3a1756(0x180)]=0x2,_0x4363d1['remark']='住户积极配合网格员的走访，如实回答了相关问题'):(_0x4363d1[_0x3a1756(0x180)]=0x0,_0x4363d1['remark']='');}),_[_0x5d1003(0x184)](_0xe646ee[0x2])['forEach'](_0x2fa43d=>{const _0x344bc6=_0x5d1003;_0x2fa43d['status']=0x0,_0x2fa43d[_0x344bc6(0x16f)]='';}),_0x13efc2[0x0]['progress']=_0x13efc2[0x1]['progress']=_0xe646ee,_0x13efc2;}module[a28_0x221948(0x18d)]={'getNewTimeStamp':getNewTimeStamp,'updateAccidentTime':updateAccidentTime,'addFireTask':addFireTask,'addTask':addTask,'getRelatedTaskListByUserId':getRelatedTaskListByUserId,'acceptTask':acceptTask,'appointTask':appointTask,'gridAcceptTask':gridAcceptTask,'gridFinishTask':gridFinishTask,'appointTaskToGrid':appointTaskToGrid,'getFakeInterviewInformation':getFakeInterviewInformation};